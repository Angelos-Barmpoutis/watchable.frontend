<div class="wrapper">
    <section>
        <header>
            <app-section-header title="Search Results"> </app-section-header>
            <app-tabs [tabs]="searchTabs" (tabChange)="changeSearchOption($event)"> </app-tabs>
        </header>

        <div class="list-container">
            <ng-container *ngIf="searchQuery">
                <ng-container [ngSwitch]="searchOption">
                    <ng-container *ngSwitchCase="SEARCH_OPTION.Movie">
                        <ng-container *ngIf="!isLoading; else loadingState">
                            <app-movie-list-item
                                *ngFor="let movie of searchMovies; trackBy: trackByItemId"
                                [movie]="movie"
                                [isLoading]="false"
                            ></app-movie-list-item>
                        </ng-container>
                        <p *ngIf="searchMovies.length === 0" class="no-results">
                            No movies found for "{{ searchQuery }}"
                        </p>
                    </ng-container>

                    <ng-container *ngSwitchCase="SEARCH_OPTION.Tv">
                        <ng-container *ngIf="!isLoading; else loadingState">
                            <app-tv-show-list-item
                                *ngFor="let tvShow of searchTvShows; trackBy: trackByItemId"
                                [tvShow]="tvShow"
                                [isLoading]="false"
                            ></app-tv-show-list-item>
                        </ng-container>
                        <p *ngIf="searchTvShows.length === 0" class="no-results">
                            No TV shows found for "{{ searchQuery }}"
                        </p>
                    </ng-container>

                    <ng-container *ngSwitchCase="SEARCH_OPTION.Person">
                        <ng-container *ngIf="!isLoading; else loadingState">
                            <app-person-list-item
                                *ngFor="let person of searchPeople; trackBy: trackByItemId"
                                [person]="person"
                                [isLoading]="false"
                            ></app-person-list-item>
                        </ng-container>
                        <p *ngIf="searchPeople.length === 0" class="no-results">
                            No people found for "{{ searchQuery }}"
                        </p>
                    </ng-container>
                </ng-container>

                <app-infinite-scroll-loader
                    [disabled]="isLoading || currentPage >= totalPages"
                    (scrolled)="loadMore()"
                ></app-infinite-scroll-loader>
            </ng-container>
        </div>
    </section>
</div>

<ng-template #loadingState>
    <ng-container [ngSwitch]="searchOption">
        <ng-container *ngSwitchCase="SEARCH_OPTION.Movie">
            <app-movie-list-item *ngFor="let item of skeletonArray; trackBy: trackByIndex" [isLoading]="true">
            </app-movie-list-item>
        </ng-container>
        <ng-container *ngSwitchCase="SEARCH_OPTION.Tv">
            <app-tv-show-list-item *ngFor="let item of skeletonArray; trackBy: trackByIndex" [isLoading]="true">
            </app-tv-show-list-item>
        </ng-container>
        <ng-container *ngSwitchCase="SEARCH_OPTION.Person">
            <app-person-list-item *ngFor="let item of skeletonArray; trackBy: trackByIndex" [isLoading]="true">
            </app-person-list-item>
        </ng-container>
    </ng-container>
</ng-template>
