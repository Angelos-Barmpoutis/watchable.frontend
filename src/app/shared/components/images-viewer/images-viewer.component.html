<ng-container *ngIf="!isLoading; else loadingTemplate">
    <div appFadeIn class="images-grid">
        <div
            *ngFor="let image of images | slice: 0 : DEFAULT.imagesCount; let i = index"
            class="image-item"
            (click)="openViewer(i)"
        >
            <img
                appBackdropPath
                class="grid-image"
                alt="Media image"
                [backdropPath]="image.file_path"
                [size]="BACKDROP_SIZE.w780"
            />
            <div
                *ngIf="i === DEFAULT.imagesCount - 1 && images.length > DEFAULT.imagesCount"
                class="more-images"
                (click)="openViewer(i)"
            >
                <span class="counter">+{{ images.length - DEFAULT.imagesCount }} more</span>
            </div>
        </div>
    </div>

    <div *ngIf="showViewer" appFadeIn class="image-viewer">
        <div class="viewer-content">
            <button title="Close" aria-label="Close" class="close-button" (click)="closeViewer()">
                <i class="fas fa-times"></i>
            </button>

            <div class="viewer-strip-container">
                <swiper-container
                    #viewerStrip
                    class="viewer-strip"
                    [slidesPerView]="1"
                    [initialSlide]="selectedImageIndex"
                    (swiperslidechange)="onViewerSlideChange($event)"
                >
                    <swiper-slide *ngFor="let image of images">
                        <img
                            appBackdropPath
                            alt="Viewer image"
                            [backdropPath]="image.file_path"
                            [size]="BACKDROP_SIZE.original"
                        />
                    </swiper-slide>
                </swiper-container>
            </div>

            <swiper-container
                #previewStrip
                class="preview-strip"
                [spaceBetween]="8"
                [slidesPerView]="'auto'"
                [initialSlide]="selectedImageIndex"
            >
                <swiper-slide
                    *ngFor="let image of images; let i = index"
                    [class.active]="i === selectedImageIndex"
                    (click)="selectImage(i)"
                >
                    <img appBackdropPath alt="Thumbnail" [backdropPath]="image.file_path" [size]="BACKDROP_SIZE.w300" />
                </swiper-slide>
            </swiper-container>
        </div>
    </div>
</ng-container>

<ng-template #loadingTemplate>
    <div appFadeIn class="skeleton-grid">
        <div *ngFor="let i of skeletonArray" class="skeleton-image-item">
            <div class="skeleton-image"></div>
        </div>
    </div>
</ng-template>
